# shares process using the port 
# usage: whoseport <port number>
whoseport() { 
    echo "checking port[$1] is free for use"
    lsof -i ":$1" | grep LISTEN 
}

# open visualstudio code
code () { 
   VSCODE_CWD="$PWD" open -n -b "com.microsoft.VSCode" --args $* ;
}

# logs new credentials everyday
awscreds() {
    sr_aws_envs=(prod-ro preprod-dev legacy-dev)
    print $sr_aws_envs
    for aws_env in $sr_aws_envs; do
        aws-okta write-to-credentials -a 12h -t 12h $aws_env  ~/.aws/credentials
        print "aws[$aws_env] credentials configured."
    done
}

dhelp() {
    cat ~/dotfiles/man.md
}

# docker tools
docker-clean() {
    print "cleaning docker none images "
    images=$(docker images --filter "dangling=true" -q --no-trunc)
        if [ -n "$images" ]
    then
        docker rmi -f $images
    fi
}

gitd() {
  gitBranchString=$1   
  gitBranches=("${(@s/,/)gitBranchString}")
  for gitBranch in $gitBranches; do 
    echo "deleting.....  $gitBranch"  
    git branch -D $gitBranch  && git push origin --delete $gitBranch 2>> /dev/null
    echo 
  done
}

# Run `dig` and display the most useful info
function digga() {
	dig +nocmd "$1" any +multiline +noall +answer;
}


# setting up python virtual environment (.venv/bin/activate) 
# and PYTHONPATH=local directory
function venv() {
    if [ -f $(pwd)/.venv/bin/activate ]; then
        source $(pwd)/.venv/bin/activate
    fi
    export PYTHONPATH=$(pwd)
    echo "set python path to = $PYTHONPATH"
}
